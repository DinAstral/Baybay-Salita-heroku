import{d as E,u as B,r as i,U as $,a as p,_ as d,j as e}from"./index-5TaQTwNN.js";import{C as _}from"./ContentHeader-Bv4ioZUH.js";import{P as S}from"./ParentSidebar-Dqhlk0_R.js";import{p as w,t as A}from"./profile-D8zIq00Q.js";import{F as h,d as L,k as q,f as G}from"./index-BEoJg6_O.js";import{b as u}from"./chunk-DBLREEYE-8wHPzRBu.js";import{i as m}from"./chunk-GQQM5TNQ-ibcJnNW_.js";import{s as Y,l as f}from"./chunk-CEHIK4GH-CSSFeYKd.js";import"./useOverlayTriggerState-C_EUMqcn.js";import"./chunk-CIZQCQPA-bQqN0Oqc.js";import"./chunk-CAFRINWI-CMvs8fyY.js";import"./useFormReset-BYks3PA_.js";import"./useField-C_Jg6yOI.js";import"./useLabels-BgdmEoId.js";import"./useDialog-dIOe2-q7.js";import"./VisuallyHidden-DpHn1mm0.js";const M=()=>{const g=E(),C=B(),{user:s}=i.useContext($),[x,j]=i.useState(0);i.useState(!1);const[D,N]=i.useState(w),[o,I]=i.useState({}),[v,F]=i.useState(null),[t,c]=i.useState({});i.useEffect(()=>{p.get(`/api/getParent/${s.UserID}`).then(a=>{N(a.data.Picture||w),I(a.data),c(a.data)}).catch(()=>{d.error("Failed to fetch parent data. Please try again later.")})},[s.UserID]),i.useEffect(()=>{const r=["/parentProfile"].findIndex(l=>l===g.pathname);j(r)},[g.pathname]),i.useEffect(()=>{o.Birthday&&F((r=>{const l=new Date(r),n=new Date;let y=n.getFullYear()-l.getFullYear();const P=n.getMonth()-l.getMonth();return(P<0||P===0&&n.getDate()<l.getDate())&&y--,y})(o.Birthday))},[o.Birthday]);const U=async a=>{const r=a.target.files[0];if(r){const l=new FormData;l.append("Profile",r),l.append("role",s.role),l.append("UserID",s.UserID);try{const n=await p.post("/api/profileUpdate",l,{headers:{"Content-Type":"multipart/form-data"}});n.data.message?(N(n.data.updatedProfileUrl),d.success("Profile picture updated successfully!")):n.data.error&&d.error(`Error: ${n.data.error}`)}catch{d.error("Failed to update profile picture. Please try again later.")}}},b=a=>{j(a)},k=async a=>{a.preventDefault();try{const r=await p.patch(`/api/updateParent/${t.UserID}`,t);if(r.status===200&&r.data){d.success("Your profile updated successfully!");const l=await p.get(`/api/getParent/${t.UserID}`);c(l.data)}else d.error(`Error: ${r.data.error||"Update failed."}`)}catch(r){console.error("Error updating parent profile:",r),r.response?d.error(`Failed to update parent profile: ${r.response.data.error||"Please try again later."}`):r.request?d.error("No response from server. Please check your connection."):d.error("Failed to update parent profile. Please try again later.")}};return e.jsxs("div",{className:"p-10",children:[e.jsxs("div",{className:"flex items-center justify-start gap-2 mb-5",children:[e.jsx("h1",{className:"text-3xl font-semibold",children:"Parent Profile"}),e.jsx(A,{showArrow:!0,content:e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"text-sm font-bold",children:"Profile Information"}),e.jsx("div",{className:"text-xs",children:"This function will view your profile."})]}),children:e.jsx(h,{icon:L,className:"text-gray-600"})})]}),e.jsxs("div",{className:"w-full max-w-8xl mx-auto bg-white shadow-lg rounded-lg p-[3rem]",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start gap-6 relative",children:[e.jsx(A,{content:e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"text-sm font-bold",children:"Profile Picture Update"}),e.jsx("div",{className:"text-xs",children:"You can update your profile picture once clicked."})]}),children:e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("img",{src:D,className:"w-32 h-32 rounded-full",alt:"Profile"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:U})]})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-2xl font-bold",children:s?`${s.FirstName} ${s.LastName}`:"Parent Name"}),e.jsx("h3",{children:s?s.role:"Role"}),e.jsxs("div",{className:"flex flex-col mt-4 text-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{icon:q,className:"text-gray-600"}),e.jsxs("span",{children:["Parent ID Number: ",s?s.UserID:"Parent ID"]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(h,{icon:G,className:"text-gray-600"}),e.jsxs("span",{children:["Email Address: ",s?s.email:"Email Address"]})]})]})]}),e.jsx(u,{color:"primary",onClick:()=>C(-1),children:"Back"})]}),e.jsxs("div",{className:"mt-8",children:[e.jsxs("div",{className:"flex gap-6 border-b pb-2",children:[e.jsx(u,{variant:"light",radius:"none",className:`text-md font-medium ${x===0?"border-b-4 border-blue-500":""}`,onClick:()=>b(0),children:"Basic Information"}),e.jsx(u,{variant:"light",radius:"none",className:`text-md font-medium ${x===1?"border-b-4 border-blue-500":""}`,onClick:()=>b(1),children:"Update"})]}),x===0&&e.jsx("div",{className:"mt-6 bg-[#faf9f4] p-6 rounded-lg shadow",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"block text-sm text-gray-600",children:"First Name:"}),e.jsx("p",{className:"text-gray-800",children:s?s.FirstName:"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-sm text-gray-600",children:"Contact Number:"}),e.jsx("p",{className:"text-gray-800",children:o.ContactNumber||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-sm text-gray-600",children:"Last Name:"}),e.jsx("p",{className:"text-gray-800",children:s?s.LastName:"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-sm text-gray-600",children:"Gender:"}),e.jsx("p",{className:"text-gray-800",children:o.Gender||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-sm text-gray-600",children:"Birthday:"}),e.jsx("p",{className:"text-gray-800",children:o.Birthday||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-sm text-gray-600",children:"Age:"}),e.jsx("p",{className:"text-gray-800",children:v!==null?v:"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-sm text-gray-600",children:"Address:"}),e.jsx("p",{className:"text-gray-800",children:o.Address||"N/A"})]})]})}),x===1&&e.jsxs("form",{onSubmit:k,className:"mt-6 bg-[#faf9f4] p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Update Your Profile"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(m,{required:!0,label:"First Name",value:t.FirstName||"",onChange:a=>c({...t,FirstName:a.target.value})}),e.jsx(m,{required:!0,label:"Last Name",value:t.LastName||"",onChange:a=>c({...t,LastName:a.target.value})}),e.jsxs(Y,{label:"Gender",value:t.Gender||"",onChange:a=>c({...t,Gender:a}),children:[e.jsx(f,{value:"Male",children:"Male"}),e.jsx(f,{value:"Female",children:"Female"}),e.jsx(f,{value:"Other",children:"Other"})]}),e.jsx(m,{required:!0,type:"date",label:"Birthday",value:t.Birthday||"",onChange:a=>c({...t,Birthday:a.target.value})}),e.jsx(m,{required:!0,label:"Contact Number",value:t.ContactNumber||"",onChange:a=>c({...t,ContactNumber:a.target.value})}),e.jsx(m,{label:"Address",value:t.Address||"",onChange:a=>c({...t,Address:a.target.value})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(u,{type:"submit",color:"primary",children:"Update Profile"})})]})]})]})]})},re=()=>e.jsxs("div",{className:"w-full h-full flex",children:[e.jsx("div",{className:"fixed top-0 left-0 w-[15%] h-full bg-[#F5EBD6] shadow-lg",children:e.jsx(S,{})}),e.jsxs("div",{className:"ml-[15%] w-[85%] h-full min-h-[100vh] bg-[#F2EDE3] p-[2rem] flex flex-col gap-[1.5rem]",children:[e.jsx(_,{}),e.jsx(M,{})]})]});export{re as default};

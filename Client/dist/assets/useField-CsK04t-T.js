import{r as v}from"./index-BjF_G-ic.js";import{B as F,C as g,D as R,E as L,F as D,c as U}from"./chunk-DBLREEYE-CnLlufi-.js";import{$ as j}from"./useLabels-BKDMMi_w.js";var Z=(...i)=>{let e=" ";for(const a of i)if(typeof a=="string"&&a.length>0){e=a;break}return e};function _(i,e,a){let{validationBehavior:t,focus:d}=i;F(()=>{if(t==="native"&&(a!=null&&a.current)){let l=e.realtimeValidation.isInvalid?e.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";a.current.setCustomValidity(l),a.current.hasAttribute("title")||(a.current.title=""),e.realtimeValidation.isInvalid||e.updateValidation(Q(a.current))}});let r=g(()=>{e.resetValidation()}),n=g(l=>{var s;e.displayValidation.isInvalid||e.commitValidation();let u=a==null||(s=a.current)===null||s===void 0?void 0:s.form;if(!l.defaultPrevented&&a&&u&&q(u)===a.current){var f;d?d():(f=a.current)===null||f===void 0||f.focus(),R("keyboard")}l.preventDefault()}),o=g(()=>{e.commitValidation()});v.useEffect(()=>{let l=a==null?void 0:a.current;if(!l)return;let s=l.form;return l.addEventListener("invalid",n),l.addEventListener("change",o),s==null||s.addEventListener("reset",r),()=>{l.removeEventListener("invalid",n),l.removeEventListener("change",o),s==null||s.removeEventListener("reset",r)}},[a,n,o,r,t])}function k(i){let e=i.validity;return{badInput:e.badInput,customError:e.customError,patternMismatch:e.patternMismatch,rangeOverflow:e.rangeOverflow,rangeUnderflow:e.rangeUnderflow,stepMismatch:e.stepMismatch,tooLong:e.tooLong,tooShort:e.tooShort,typeMismatch:e.typeMismatch,valueMissing:e.valueMissing,valid:e.valid}}function Q(i){return{isInvalid:!i.validity.valid,validationDetails:k(i),validationErrors:i.validationMessage?[i.validationMessage]:[]}}function q(i){for(let e=0;e<i.elements.length;e++){let a=i.elements[e];if(!a.validity.valid)return a}return null}const M={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},C={...M,customError:!0,valid:!1},b={isInvalid:!1,validationDetails:M,validationErrors:[]},N=v.createContext({}),P="__formValidationState"+Date.now();function ee(i){if(i[P]){let{realtimeValidation:e,displayValidation:a,updateValidation:t,resetValidation:d,commitValidation:r}=i[P];return{realtimeValidation:e,displayValidation:a,updateValidation:t,resetValidation:d,commitValidation:r}}return Y(i)}function Y(i){let{isInvalid:e,validationState:a,name:t,value:d,builtinValidation:r,validate:n,validationBehavior:o="aria"}=i;a&&(e||(e=a==="invalid"));let l=e!==void 0?{isInvalid:e,validationErrors:[],validationDetails:C}:null,s=v.useMemo(()=>B(z(n,d)),[n,d]);r!=null&&r.validationDetails.valid&&(r=null);let u=v.useContext(N),f=v.useMemo(()=>t?Array.isArray(t)?t.flatMap(c=>h(u[c])):h(u[t]):[],[u,t]),[w,A]=v.useState(u),[x,m]=v.useState(!1);u!==w&&(A(u),m(!1));let p=v.useMemo(()=>B(x?[]:f),[x,f]),S=v.useRef(b),[V,y]=v.useState(b),$=v.useRef(b),T=()=>{if(!O)return;E(!1);let c=s||r||S.current;I(c,$.current)||($.current=c,y(c))},[O,E]=v.useState(!1);return v.useEffect(T),{realtimeValidation:l||p||s||r||b,displayValidation:o==="native"?l||p||V:l||p||s||r||V,updateValidation(c){o==="aria"&&!I(V,c)?y(c):S.current=c},resetValidation(){let c=b;I(c,$.current)||($.current=c,y(c)),o==="native"&&E(!1),m(!0)},commitValidation(){o==="native"&&E(!0),m(!0)}}}function h(i){return i?Array.isArray(i)?i:[i]:[]}function z(i,e){if(typeof i=="function"){let a=i(e);if(a&&typeof a!="boolean")return h(a)}return[]}function B(i){return i.length?{isInvalid:!0,validationErrors:i,validationDetails:C}:null}function I(i,e){return i===e?!0:i&&e&&i.isInvalid===e.isInvalid&&i.validationErrors.length===e.validationErrors.length&&i.validationErrors.every((a,t)=>a===e.validationErrors[t])&&Object.entries(i.validationDetails).every(([a,t])=>e.validationDetails[a]===t)}function ae(...i){let e=new Set,a=!1,t={...M};for(let n of i){var d,r;for(let o of n.validationErrors)e.add(o);a||(a=n.isInvalid);for(let o in t)(d=t)[r=o]||(d[r]=n.validationDetails[o])}return t.valid=!a,{isInvalid:a,validationErrors:[...e],validationDetails:t}}function G(i){let{id:e,label:a,"aria-labelledby":t,"aria-label":d,labelElementType:r="label"}=i;e=L(e);let n=L(),o={};a?(t=t?`${n} ${t}`:n,o={id:n,htmlFor:r==="label"?e:void 0}):!t&&!d&&console.warn("If you do not provide a visible label, you must specify an aria-label or aria-labelledby attribute for accessibility");let l=j({id:e,"aria-label":d,"aria-labelledby":t});return{labelProps:o,fieldProps:l}}function ie(i){let{description:e,errorMessage:a,isInvalid:t,validationState:d}=i,{labelProps:r,fieldProps:n}=G(i),o=D([!!e,!!a,t,d]),l=D([!!e,!!a,t,d]);return n=U(n,{"aria-describedby":[o,l,i["aria-describedby"]].filter(Boolean).join(" ")||void 0}),{labelProps:r,fieldProps:n,descriptionProps:{id:o},errorMessageProps:{id:l}}}export{ie as $,ee as a,ae as b,_ as c,b as d,P as e,G as f,Z as s};

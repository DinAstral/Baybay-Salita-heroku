import{d as I,u as F,r as n,U as P,a as x,_ as d,j as e}from"./index-BXV9bpMK.js";import{C as S}from"./ContentHeader-BIjoHmmo.js";import{S as U}from"./Sidebar-CeGm-rds.js";import{p as v,t as y}from"./profile-Yf8RvZIk.js";import{F as p,d as k,k as B,f as E}from"./index-xgicLjPJ.js";import{b as h}from"./chunk-DBLREEYE-15uI-xy1.js";import{i as c}from"./chunk-GQQM5TNQ-BoIlqCBx.js";import"./useOverlayTriggerState-3bp4qIh8.js";import"./chunk-CIZQCQPA-DsFahXx_.js";import"./useField-CHGuITbW.js";import"./useLabels-BQlx2yix.js";import"./useFormReset-C52w8Xoc.js";const T=()=>{const u=I(),b=F(),[m,g]=n.useState(0),{user:o}=n.useContext(P),[A,f]=n.useState(v),[a,l]=n.useState({UserID:"",FirstName:"",LastName:"",Age:"",Section:"",Birthday:"",Gender:"",Address:"",Status:"",Nationality:"",ContactNumber:"",Picture:"",email:""});n.useEffect(()=>{x.get(`/api/getTeacher/${o.UserID}`).then(s=>{l(s.data),f(s.data.Picture||v)}).catch(()=>{d.error("Failed to fetch teacher data. Please try again later.")})},[o.UserID]),n.useEffect(()=>{const t=["/teacherProfile"].findIndex(r=>r===u.pathname);g(t)},[u.pathname]);const C=s=>{const t=new Date(s),r=new Date;let i=r.getFullYear()-t.getFullYear();const j=r.getMonth()-t.getMonth();return(j<0||j===0&&r.getDate()<t.getDate())&&i--,i};n.useEffect(()=>{if(a.Birthday){const s=C(a.Birthday);l(t=>({...t,Age:s}))}},[a.Birthday]);const w=async s=>{const t=s.target.files[0];if(t){const r=new FormData;r.append("Profile",t),r.append("role",o.role),r.append("UserID",o.UserID);try{const i=await x.post("/api/profileUpdate",r,{headers:{"Content-Type":"multipart/form-data"}});i.data.message?(f(i.data.updatedProfileUrl),d.success("Profile picture updated successfully!")):i.data.error&&d.error(`Error: ${i.data.error}`)}catch{d.error("Failed to update profile picture. Please try again later.")}}},N=s=>{g(s)},D=async s=>{s.preventDefault();try{const t=await x.patch(`/api/updateTeacher/${a.UserID}`,a);if(t.data.success){d.success(t.data.message);const r=await x.get(`/api/getTeacher/${a.UserID}`);l(r.data)}else d.error(t.data.message||"Update failed.")}catch(t){console.error(t),d.error("An unexpected error occurred. Please try again later.")}};return e.jsxs("div",{className:"p-10",children:[e.jsxs("div",{className:"flex items-center justify-start gap-2 mb-5",children:[e.jsx("h1",{className:"text-3xl font-semibold",children:"Your Profile"}),e.jsx(y,{showArrow:!0,content:e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"text-sm font-bold",children:"Profile Information"}),e.jsx("div",{className:"text-xs",children:"This function will view your information."})]}),children:e.jsx(p,{icon:k,className:"text-gray-600"})})]}),e.jsxs("div",{className:"w-full max-w-8xl mx-auto bg-white shadow-lg rounded-lg p-[3rem]",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start gap-6 relative",children:[e.jsx(y,{content:e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"text-sm font-bold",children:"Profile Picture Update"}),e.jsx("div",{className:"text-xs",children:"You can update your profile picture once clicked."})]}),children:e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("img",{src:A,className:"w-32 h-32 rounded-full",alt:"Profile"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:w})]})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-2xl font-bold",children:a?`${a.FirstName} ${a.LastName}`:"Teacher Name"}),e.jsx("h4",{children:o?`Adviser of ${a.Section}`:"Adviser of Section"}),e.jsxs("div",{className:"flex flex-col mt-4 text-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{icon:B,className:"text-gray-600"}),e.jsxs("span",{children:["Teacher ID Number: ",a?a.UserID:"Teacher ID"]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(p,{icon:E,className:"text-gray-600"}),e.jsxs("span",{children:["Email Address: ",a?a.email:"Email Address"]})]})]})]}),e.jsx(h,{color:"primary",className:"w-[120px] text-md p-1",onClick:()=>b(-1),children:"Back"})]}),e.jsxs("div",{className:"mt-8",children:[e.jsxs("div",{className:"flex gap-6 border-b pb-2",children:[e.jsx(h,{variant:"light",radius:"none",className:`text-md font-medium ${m===0?"border-b-4 border-blue-500":""}`,onClick:()=>N(0),children:"Basic Information"}),e.jsx(h,{variant:"light",radius:"none",className:`text-md font-medium ${m===1?"border-b-4 border-blue-500":""}`,onClick:()=>N(1),children:"Update"})]}),m===0&&e.jsx("div",{className:"mt-6 bg-[#faf9f4] p-6 rounded-lg shadow",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"block text-sm text-gray-600",children:"First Name:"}),e.jsx("p",{className:"text-gray-800",children:a.FirstName||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-sm text-gray-600",children:"Civil Status:"}),e.jsx("p",{className:"text-gray-800",children:a.Status||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-sm text-gray-600",children:"Last Name:"}),e.jsx("p",{className:"text-gray-800",children:a.LastName||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-sm text-gray-600",children:"Gender:"}),e.jsx("p",{className:"text-gray-800",children:a.Gender||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-sm text-gray-600",children:"Age:"}),e.jsx("p",{className:"text-gray-800",children:a.Age||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-sm text-gray-600",children:"Birthday:"}),e.jsx("p",{className:"text-gray-800",children:a.Birthday||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-sm text-gray-600",children:"Nationality:"}),e.jsx("p",{className:"text-gray-800",children:a.Nationality||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-sm text-gray-600",children:"Address:"}),e.jsx("p",{className:"text-gray-800",children:a.Address||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-sm text-gray-600",children:"Contact Number:"}),e.jsx("p",{className:"text-gray-800",children:a.ContactNumber||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-sm text-gray-600",children:"Section:"}),e.jsx("p",{className:"text-gray-800",children:a.Section||"N/A"})]})]})}),m===1&&e.jsx("div",{className:"mt-6 bg-[#faf9f4] p-6 rounded-lg shadow",children:e.jsxs("form",{onSubmit:D,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(c,{label:"First Name",value:a.FirstName,onChange:s=>l({...a,FirstName:s.target.value})}),e.jsx(c,{label:"Last Name",value:a.LastName,onChange:s=>l({...a,LastName:s.target.value})}),e.jsx(c,{label:"Gender",value:a.Gender,onChange:s=>l({...a,Gender:s.target.value})}),e.jsx(c,{label:"Birthday",type:"date",value:a.Birthday,onChange:s=>l({...a,Birthday:s.target.value})}),e.jsx(c,{label:"Nationality",value:a.Nationality,onChange:s=>l({...a,Nationality:s.target.value})}),e.jsx(c,{label:"Address",value:a.Address,onChange:s=>l({...a,Address:s.target.value})}),e.jsx(c,{label:"Contact Number",value:a.ContactNumber,onChange:s=>l({...a,ContactNumber:s.target.value})}),e.jsx(c,{label:"Section",value:a.Section,onChange:s=>l({...a,Section:s.target.value})})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(h,{type:"submit",color:"primary",children:"Update"})})]})})]})]})]})},O=()=>e.jsxs("div",{className:"w-full h-full flex",children:[e.jsx("div",{className:"fixed top-0 left-0 w-[15%] h-full bg-[#F5EBD6] shadow-lg",children:e.jsx(U,{})}),e.jsxs("div",{className:"ml-[15%] w-[85%] h-full min-h-[100vh] bg-[#F2EDE3] p-[2rem] flex flex-col gap-[1.5rem]",children:[e.jsx(S,{}),e.jsx(T,{})]})]});export{O as default};

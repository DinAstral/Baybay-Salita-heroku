import{j as e,L as j,r as c,_ as N,a as _}from"./index-CDp9s-1W.js";import{A as Q}from"./AdminSidebar-D4aC8EgS.js";import{C as W}from"./ContentHeader-ca21HmTk.js";import{P as J,t as X,a as Z,b as y,c as ee,d as se,e as v}from"./PrintRecord-C12yHgYp.js";import{P as i,F as P,d as le,i as te,j as re}from"./index-CDqNdnzK.js";import{m as h,a as x,b as m,c as f,d as u}from"./chunk-P2T5LMDM-DrBYHDTy.js";import{b as a}from"./chunk-DBLREEYE-DLc9hqlN.js";import{l as ie}from"./index-eKziJxgS.js";import{R as ae}from"./react-paginate-CaWNM49Y.js";import{t as E}from"./profile-e_Xy1BOS.js";import{s as ne,l as g}from"./chunk-CEHIK4GH-CHLgWv94.js";import{i as oe}from"./chunk-GQQM5TNQ-DaiCTBSg.js";import"./useOverlayTriggerState-C4XnOhmL.js";import"./useDialog-k80U-Yk1.js";import"./useLabels-DWU8JaSh.js";import"./VisuallyHidden-RdmmbtXL.js";import"./chunk-KBN3H6OQ-yo18C9k0.js";import"./chunk-CAFRINWI-CMvs8fyY.js";import"./useField-DtoybKFN.js";import"./chunk-CIZQCQPA-C8eic7BT.js";import"./useFormReset-TTb4FMjO.js";const I=({show:t,onHide:l})=>e.jsx(h,{isOpen:t,onClose:l,"aria-labelledby":"add-user-modal-title",isDismissable:!1,isKeyboardDismissDisabled:!0,children:e.jsxs(x,{children:[e.jsx(m,{className:"flex flex-col",id:"add-user-modal-title",children:"Add User Information"}),e.jsx(f,{children:e.jsx("p",{children:"Do you want to add a user?"})}),e.jsxs(u,{children:[e.jsx(a,{color:"danger",variant:"light",onClick:l,children:"Cancel"}),e.jsx(j,{to:"/adminAddUser",children:e.jsx(a,{color:"primary",children:"Add"})})]})]})});I.propTypes={show:i.bool.isRequired,onHide:i.func.isRequired};const V=({show:t,onHide:l,user:s})=>e.jsx(h,{isOpen:t,onClose:l,"aria-labelledby":"edit-user-modal-title",isDismissable:!1,isKeyboardDismissDisabled:!0,children:e.jsxs(x,{children:[e.jsx(m,{className:"flex flex-col",id:"edit-user-modal-title",children:"Add User Information"}),e.jsx(f,{children:e.jsx("p",{children:"You are now going to update the selected user. Do you wish to continue?"})}),e.jsxs(u,{children:[e.jsx(a,{variant:"light",color:"danger",onClick:l,children:"Cancel"}),e.jsx(j,{to:`/AdminEditUser/${s==null?void 0:s.UserID}`,children:e.jsx(a,{color:"primary",children:"Update"})})]})]})});V.propTypes={show:i.bool.isRequired,onHide:i.func.isRequired,user:i.object};const F=({show:t,onHide:l,user:s})=>e.jsx(h,{isOpen:t,onClose:l,"aria-labelledby":"contained-modal-title-vcenter",isDismissable:!1,isKeyboardDismissDisabled:!0,children:e.jsxs(x,{children:[e.jsx(m,{className:"flex flex-col",id:"edit-user-modal-title",children:"View Parent Information"}),e.jsx(f,{children:e.jsx("p",{children:"Do you want to View the profile of Parent selected?"})}),e.jsxs(u,{children:[e.jsx(a,{color:"danger",variant:"light",onClick:l,children:"Cancel"}),e.jsx(j,{to:`/adminViewParent/${s==null?void 0:s.UserID}`,children:e.jsx(a,{color:"primary",children:"View"})})]})]})});F.propTypes={show:i.bool.isRequired,onHide:i.func.isRequired,user:i.object};const H=({show:t,onHide:l,user:s})=>e.jsx(h,{isOpen:t,onClose:l,"aria-labelledby":"contained-modal-title-vcenter",isDismissable:!1,isKeyboardDismissDisabled:!0,children:e.jsxs(x,{children:[e.jsx(m,{className:"flex flex-col",id:"edit-user-modal-title",children:"View Teacher Information"}),e.jsx(f,{children:e.jsx("p",{children:"Do you want to view the profile of teacher selected?"})}),e.jsxs(u,{children:[e.jsx(a,{color:"danger",variant:"light",onClick:l,children:"Cancel"}),e.jsx(j,{to:`/adminViewTeacher/${s==null?void 0:s.UserID}`,children:e.jsx(a,{color:"primary",children:"View"})})]})]})});H.propTypes={show:i.bool.isRequired,onHide:i.func.isRequired,user:i.object};const K=({show:t,onHide:l,user:s})=>e.jsx(h,{isOpen:t,onClose:l,"aria-labelledby":"contained-modal-title-vcenter",isDismissable:!1,isKeyboardDismissDisabled:!0,children:e.jsxs(x,{children:[e.jsx(m,{className:"flex flex-col",id:"contained-modal-title-vcenter",children:"Update Parent Information"}),e.jsx(f,{children:e.jsx("p",{children:"Are you sure you want to update this parent's information?"})}),e.jsxs(u,{children:[e.jsx(a,{color:"danger",variant:"light",onClick:l,children:"Cancel"}),e.jsx(j,{to:`/adminEditParent/${s==null?void 0:s._id}`,children:e.jsx(a,{color:"primary",children:"Update"})})]})]})});K.propTypes={show:i.bool.isRequired,onHide:i.func.isRequired,user:i.object};const L=({show:t,onHide:l,user:s})=>e.jsx(h,{isOpen:t,onClose:l,"aria-labelledby":"contained-modal-title-vcenter",isDismissable:!1,isKeyboardDismissDisabled:!0,children:e.jsxs(x,{children:[e.jsx(m,{className:"flex flex-col",id:"contained-modal-title-vcenter",children:"Update Teacher Information"}),e.jsx(f,{children:e.jsx("p",{children:"Are you sure you want to update this teacher's information?"})}),e.jsxs(u,{children:[e.jsx(a,{color:"danger",variant:"light",onClick:l,children:"Cancel"}),e.jsx(j,{to:`/adminEditTeacher/${s==null?void 0:s._id}`,children:e.jsx(a,{color:"primary",children:"Update"})})]})]})});L.propTypes={show:i.bool.isRequired,onHide:i.func.isRequired,user:i.object};const de=({show:t,onHide:l})=>e.jsx(h,{isOpen:t,onClose:l,"aria-labelledby":"contained-modal-title-vcenter",isDismissable:!1,isKeyboardDismissDisabled:!0,children:e.jsxs(x,{children:[e.jsx(m,{id:"contained-modal-title-vcenter",children:"Delete User Successful"}),e.jsx(f,{children:e.jsx("p",{children:"You have successfully deleted the User's information."})}),e.jsx(u,{children:e.jsx(a,{color:"danger",onClick:l,children:"Close"})})]})}),O=({show:t,onHide:l,user:s,onDeleteSuccess:o})=>{const[d,p]=c.useState(!1),C=async()=>{try{if(!s||!s.email){N.error("User not found.");return}(await _.delete(`/api/deleteUser/${s.email}`)).status===200?(p(!0),o()):N.error("Failed to delete user. Please try again.")}catch(w){console.error("Error deleting user:",w),N.error("Failed to delete user. Please try again later.")}};return e.jsxs(e.Fragment,{children:[e.jsx(h,{isOpen:t,onClose:l,"aria-labelledby":"contained-modal-title-vcenter",isDismissable:!1,isKeyboardDismissDisabled:!0,children:e.jsxs(x,{children:[e.jsx(m,{id:"contained-modal-title-vcenter",children:"Delete User Information"}),e.jsx(f,{children:e.jsx("p",{children:"Are you sure you want to delete this User's information?"})}),e.jsxs(u,{children:[e.jsx(a,{color:"default",variant:"light",onClick:l,children:"Cancel"}),e.jsx(a,{color:"danger",onClick:C,children:"Delete"})]})]})}),e.jsx(de,{show:d,onHide:()=>{p(!1),l()}})]})};O.propTypes={show:i.bool.isRequired,onHide:i.func.isRequired,onDeleteSuccess:i.func.isRequired,user:i.object};const ce=(t,l,s)=>{let o=t;return l!=="default"&&(o=o.filter(d=>d.role===l)),s&&(o=o.filter(d=>d.email.toLowerCase().includes(s.toLowerCase()))),o},he=(t,l,s)=>{const o=l*s;return t.slice(o,o+s)},xe=()=>{const[t,l]=c.useState({add:!1,print:!1,editUser:!1,editTeacher:!1,viewTeacher:!1,editParent:!1,viewParent:!1,delete:!1}),[s,o]=c.useState([]),[d,p]=c.useState(null),[C,w]=c.useState(0),[T]=c.useState(10),[R,M]=c.useState(""),[S,$]=c.useState("default"),A=c.useRef(null),{onDownload:z}=ie.useDownloadExcel({currentTableRef:A.current,filename:"User_List_Report",sheet:"User",data:s.map(({_id:r,...b})=>b)}),k=async()=>{try{const[r,b]=await Promise.all([_.get("/api/getTeacher"),_.get("/api/getParent")]),D=r.data.map(U=>({...U,role:"Teacher"})),G=b.data.map(U=>({...U,role:"Parent"}));o([...D,...G])}catch(r){console.error(r)}};c.useEffect(()=>{k()},[]);const q=ce(s,S,R),B=he(q,C,T),n=(r,b)=>{l(D=>({...D,[r]:b}))},Y=r=>{w(r.selected)};return e.jsxs("div",{className:"px-4 md:px-9",children:[e.jsx(I,{show:t.add,onHide:()=>n("add",!1)}),e.jsx(V,{show:t.editUser,onHide:()=>n("editUser",!1),user:d}),e.jsx(J,{show:t.print,onHide:()=>n("print",!1),print:z}),e.jsx(H,{show:t.viewTeacher,user:d,onHide:()=>n("viewTeacher",!1)}),e.jsx(L,{show:t.editTeacher,user:d,onHide:()=>n("editTeacher",!1)}),e.jsx(F,{show:t.viewParent,user:d,onHide:()=>n("viewParent",!1)}),e.jsx(K,{show:t.editParent,user:d,onHide:()=>n("editParent",!1)}),e.jsx(O,{show:t.delete,onHide:()=>n("delete",!1),user:d,onDeleteSuccess:k}),e.jsxs("div",{className:"flex justify-between items-center mb-6 px-2",children:[e.jsxs("div",{className:"text-2xl md:text-3xl font-semibold",children:["Manage User",e.jsx(E,{showArrow:!0,content:e.jsxs("div",{className:"px-1 py-2",children:[e.jsx("div",{className:"text-small font-bold",children:"User Table"}),e.jsx("div",{className:"text-tiny",children:"This function will view the information of the students in the system."})]}),children:e.jsx(P,{icon:le,size:"1x",className:"ml-2 cursor-pointer text-lg"})})]}),e.jsx("div",{className:"cursor-pointer flex items-center",children:e.jsx(E,{showArrow:!0,content:e.jsxs("div",{className:"px-1 py-2",children:[e.jsx("div",{className:"text-small font-bold",children:"Print"}),e.jsx("div",{className:"text-tiny",children:"Generate report/Print table"})]}),children:e.jsx(P,{icon:te,className:" pr-10 cursor-pointer text-lg size-8",onClick:()=>n("print",!0)})})})]}),e.jsxs("div",{className:"max-w-full min-h-[75vh] bg-white p-4 md:p-6 rounded-3xl",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-4",children:[e.jsxs(ne,{labelPlacement:"outside",label:"Role",variant:"bordered",className:"bg-transparent w-full md:w-1/5",onChange:r=>$(r.target.value),value:S,children:[e.jsx(g,{children:"All"},"default"),e.jsx(g,{children:"Admin"},"Admin"),e.jsx(g,{children:"Parent"},"Parent"),e.jsx(g,{children:"Teacher"},"Teacher")]}),e.jsx("div",{className:"w-full md:w-[40%] flex items-center mt-4 md:mt-4",children:e.jsx(oe,{variant:"bordered",type:"text",placeholder:"Enter User Email",value:R,onChange:r=>M(r.target.value),startContent:e.jsx(P,{icon:re,size:"1x",inverse:!0,className:"text-2xl text-default-400 pointer-events-none flex-shrink-0"})})}),e.jsx("div",{className:"mt-4 md:mt-4",children:e.jsx(a,{color:"primary",className:"w-full md:w-[120px] text-md",onClick:()=>n("add",!0),children:"Add User"})})]}),e.jsx("div",{className:"overflow-auto max-h-[600px]",children:e.jsxs(X,{"aria-label":"User Table",ref:A,removeWrapper:!0,color:"primary",selectionMode:"single",className:"w-full whitespace-nowrap",children:[e.jsxs(Z,{children:[e.jsx(y,{children:"UserID"}),e.jsx(y,{children:"Email"}),e.jsx(y,{children:"Role"}),e.jsx(y,{className:"text-center",children:"Actions"})]}),e.jsx(ee,{emptyContent:"No rows to display.",children:B.map(r=>e.jsxs(se,{children:[e.jsx(v,{children:r.UserID}),e.jsx(v,{children:r.email}),e.jsx(v,{children:r.role}),e.jsx(v,{className:"text-center",children:e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsx(a,{color:"default",onClick:()=>{p(r),r.role==="Teacher"?n("viewTeacher",!0):r.role==="Parent"&&n("viewParent",!0)},children:"View"}),e.jsx(a,{color:"primary",onClick:()=>p(r)||n("editUser",!0),children:"Update"}),e.jsx(a,{className:"bg-[#ff505b] text-white",onClick:()=>{p(r),n("delete",!0)},children:"Delete"})]})})]},r.UserID))})]})}),e.jsx(ae,{pageCount:Math.ceil(q.length/T),onPageChange:Y,containerClassName:"flex justify-center mt-4 space-x-2",activeClassName:"text-white bg-blue-600 hover:bg-gray-200 px-3 py-1 rounded",pageLinkClassName:"px-2 py-1 rounded",previousLinkClassName:"px-2 py-1  rounded",nextLinkClassName:"px-2 py-1 rounded"})]})]})},qe=()=>e.jsxs("div",{className:"w-full h-full flex",children:[e.jsx("div",{className:"fixed top-0 left-0 w-[15%] h-full bg-[#F5EBD6] shadow-lg",children:e.jsx(Q,{})}),e.jsxs("div",{className:"ml-[15%] w-[85%] h-full min-h-[100vh] bg-[#F2EDE3] p-[2rem] flex flex-col gap-[1.5rem]",children:[e.jsx(W,{}),e.jsx(xe,{})]})]});export{qe as default};
